import{c as X,r as n,y as r,j as e,L as w}from"./index-CTUOLzox.js";import{P as H}from"./ReactToastify-DJDUlzPv.js";import{u as le,a as ie}from"./useUpdateProject-nTDgg2Uz.js";import{S as ce,G as re,L as oe}from"./search-Bu6W58RX.js";import{S as U,T as $}from"./trash-2-DNwAXozX.js";import{c as de,X as R}from"./x-BCj5FFbu.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],Q=de("building",me),ue=()=>{const{isLoading:o,error:m,data:l,setError:i,_execute:u}=X(),p=n.useCallback(async(f,x={})=>{try{return await u("projects","POST",f,x)}catch(c){throw i(c),c}},[u,i]);return{isLoading:o,error:m,data:l,execute:p,setError:i}},he=()=>{const{isLoading:o,error:m,data:l,setError:i,_execute:u}=X(),p=n.useCallback(async(f,x={})=>{try{return await u(`projects/${f}`,"DELETE",null,x)}catch(c){throw i(c),c}},[u,i]);return{isLoading:o,error:m,data:l,execute:p,setError:i}},S={RESIDENTIAL:"سكني",COMMERCIAL:"تجاري",INDUSTRIAL:"صناعي",LAND:"أرض",MIXED_USE:"متعدد الاستخدامات",MANAGERIAL:"إداري",CLINICS:"عيادات"},pe="_projectsPage_1qpkx_1",xe="_header_1qpkx_11",je="_title_1qpkx_25",_e="_headerActions_1qpkx_37",Ne="_searchContainer_1qpkx_49",be="_searchIcon_1qpkx_59",ve="_searchInput_1qpkx_75",fe="_viewToggle_1qpkx_105",ge="_viewButton_1qpkx_119",ke="_activeView_1qpkx_153",ye="_addButton_1qpkx_173",Le="_emptyState_1qpkx_219",Ce="_projectsGrid_1qpkx_247",Be="_projectsList_1qpkx_261",qe="_projectListItem_1qpkx_273",Ie="_projectListHeader_1qpkx_301",we="_projectListContent_1qpkx_315",Se="_projectListDetails_1qpkx_327",De="_projectCard_1qpkx_337",Me="_projectHeader_1qpkx_367",Ae="_projectName_1qpkx_385",Pe="_actions_1qpkx_397",Ve="_editButton_1qpkx_407",Ee="_deleteButton_1qpkx_409",Ge="_projectDetails_1qpkx_503",Oe="_detailItem_1qpkx_513",Fe="_detailLabel_1qpkx_535",Te="_detailValue_1qpkx_545",ze="_projectFooter_1qpkx_553",He="_manageButton_1qpkx_563",Ue="_modalOverlay_1qpkx_609",$e="_modal_1qpkx_609",Re="_confirmModal_1qpkx_681",Qe="_modalHeader_1qpkx_701",Xe="_closeButton_1qpkx_735",Je="_form_1qpkx_763",Ke="_formGroup_1qpkx_771",We="_formActions_1qpkx_989",Ye="_cancelButton_1qpkx_1003",Ze="_submitButton_1qpkx_1045",es="_deleteConfirmButton_1qpkx_1095",s={projectsPage:pe,header:xe,title:je,headerActions:_e,searchContainer:Ne,searchIcon:be,searchInput:ve,viewToggle:fe,viewButton:ge,activeView:ke,addButton:ye,emptyState:Le,projectsGrid:Ce,projectsList:Be,projectListItem:qe,projectListHeader:Ie,projectListContent:we,projectListDetails:Se,projectCard:De,projectHeader:Me,projectName:Ae,actions:Pe,editButton:Ve,deleteButton:Ee,projectDetails:Ge,detailItem:Oe,detailLabel:Fe,detailValue:Te,projectFooter:ze,manageButton:He,modalOverlay:Ue,modal:$e,confirmModal:Re,modalHeader:Qe,closeButton:Xe,form:Je,formGroup:Ke,formActions:We,cancelButton:Ye,submitButton:Ze,deleteConfirmButton:es},ss=o=>{const m=new Date(o),l={year:"numeric",month:"long",day:"numeric"};return m.toLocaleDateString("ar-EG",l)},os=()=>{const[o,m]=n.useState([]),[l,i]=n.useState(""),[u,p]=n.useState(!1),[f,x]=n.useState(!1),[c,P]=n.useState(!1),[h,D]=n.useState(null),[M,V]=n.useState("cards"),[j,g]=n.useState(""),[_,k]=n.useState(""),[N,y]=n.useState("RESIDENTIAL"),[b,L]=n.useState(""),[v,C]=n.useState(""),{execute:J,isLoading:E}=le(),{execute:K,isLoading:G}=ue(),{execute:W,isLoading:O}=ie(),{execute:Y,isLoading:B}=he(),q=G||O||B;n.useEffect(()=>{I()},[]);const I=async()=>{try{const t=await J();m(t)}catch(t){r.error(t.message||"حدث خطأ أثناء تحميل بيانات المشاريع")}},A=n.useMemo(()=>o.filter(a=>a.name.toLowerCase().includes(l.toLowerCase())||a.location.toLowerCase().includes(l.toLowerCase())).sort((a,ae)=>{const ne=new Date(a.created_at).getTime();return new Date(ae.created_at).getTime()-ne}),[o,l]),Z=t=>{i(t.target.value)},F=()=>{D(null),g(""),k(""),y("RESIDENTIAL"),L(""),C(""),p(!0)},T=t=>{D(t),g(t.name),k(t.location),y(t.type),L(t.number_of_units.toString()),C(t.benefits||""),x(!0)},z=t=>{D(t),P(!0)},d=()=>{p(!1),x(!1),P(!1)},ee=async t=>{if(t.preventDefault(),!j||!_||!N||!b){r.error("يرجى ملء جميع الحقول المطلوبة");return}try{const a=new FormData;a.append("name",j),a.append("location",_),a.append("type",N),a.append("number_of_units",b),v&&a.append("benefits",v),await K(a),r.success("تم إنشاء المشروع بنجاح"),d(),I()}catch(a){r.error(a.message||"حدث خطأ أثناء إنشاء المشروع")}},se=async t=>{if(t.preventDefault(),!h||!j||!_||!N||!b){r.error("يرجى ملء جميع الحقول المطلوبة");return}try{const a=new FormData;a.append("name",j),a.append("location",_),a.append("type",N),a.append("number_of_units",b),v?a.append("benefits",v):a.append("benefits",""),await W(Number(h.id),a),r.success("تم تحديث المشروع بنجاح"),d(),I()}catch(a){r.error(a.message||"حدث خطأ أثناء تحديث المشروع")}},te=async()=>{if(h)try{await Y(Number(h.id)),r.success("تم حذف المشروع بنجاح"),d(),I()}catch(t){r.error(t.message||"حدث خطأ أثناء حذف المشروع")}};return e.jsxs("div",{className:s.projectsPage,children:[e.jsxs("div",{className:s.header,children:[e.jsx("h1",{className:s.title,children:"إدارة المشاريع"}),e.jsxs("div",{className:s.headerActions,children:[e.jsxs("div",{className:s.searchContainer,children:[e.jsx(ce,{size:18,className:s.searchIcon}),e.jsx("input",{type:"text",placeholder:"بحث بالاسم أو الموقع...",value:l,onChange:Z,className:s.searchInput})]}),e.jsxs("div",{className:s.viewToggle,children:[e.jsx("button",{className:`${s.viewButton} ${M==="cards"?s.activeView:""}`,onClick:()=>V("cards"),"aria-label":"عرض البطاقات",children:e.jsx(re,{size:18})}),e.jsx("button",{className:`${s.viewButton} ${M==="list"?s.activeView:""}`,onClick:()=>V("list"),"aria-label":"عرض القائمة",children:e.jsx(oe,{size:18})})]}),e.jsxs("button",{className:s.addButton,onClick:F,disabled:E,children:[e.jsx(H,{size:18}),e.jsx("span",{children:"إضافة مشروع"})]})]})]}),E?e.jsx(w,{isVisible:!0}):A.length===0?e.jsx("div",{className:s.emptyState,children:l?e.jsx("p",{children:"لا توجد نتائج مطابقة للبحث"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"لا توجد مشاريع حالياً"}),e.jsxs("button",{className:s.addButton,onClick:F,children:[e.jsx(H,{size:18}),e.jsx("span",{children:"إضافة مشروع"})]})]})}):M==="cards"?e.jsx("div",{className:s.projectsGrid,children:A.map(t=>e.jsxs("div",{className:s.projectCard,children:[e.jsxs("div",{className:s.projectHeader,children:[e.jsx("h3",{className:s.projectName,children:t.name}),e.jsxs("div",{className:s.actions,children:[e.jsx("button",{className:s.editButton,onClick:()=>T(t),"aria-label":"تعديل",children:e.jsx(U,{size:18})}),e.jsx("button",{className:s.deleteButton,onClick:()=>z(t),"aria-label":"حذف",children:e.jsx($,{size:18})})]})]}),e.jsxs("div",{className:s.projectDetails,children:[e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"الموقع:"}),e.jsx("span",{className:s.detailValue,children:t.location})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"النوع:"}),e.jsx("span",{className:s.detailValue,children:S[t.type]||t.type})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"عدد الوحدات:"}),e.jsx("span",{className:s.detailValue,children:t.number_of_units??"N/A"})," "]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"الوحدات المباعة:"}),e.jsx("span",{className:s.detailValue,children:t.number_of_sold_items})]}),t.benefits&&e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"المميزات:"}),e.jsx("span",{className:s.detailValue,children:t.benefits})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"تاريخ الإنشاء:"}),e.jsx("span",{className:s.detailValue,children:ss(t.created_at)})]})]}),e.jsx("div",{className:s.projectFooter,children:e.jsxs("a",{href:`/projects/${t.id}?name=${t.name}`,className:s.manageButton,children:[e.jsx(Q,{size:16}),e.jsx("span",{children:"إدارة المشروع"})]})})]},t.id))}):e.jsx("div",{className:s.projectsList,children:A.map(t=>e.jsxs("div",{className:s.projectListItem,children:[e.jsxs("div",{className:s.projectListHeader,children:[e.jsx("h3",{className:s.projectName,children:t.name}),e.jsxs("div",{className:s.actions,children:[e.jsx("button",{className:s.editButton,onClick:()=>T(t),"aria-label":"تعديل",children:e.jsx(U,{size:18})}),e.jsx("button",{className:s.deleteButton,onClick:()=>z(t),"aria-label":"حذف",children:e.jsx($,{size:18})})]})]}),e.jsxs("div",{className:s.projectListContent,children:[e.jsxs("div",{className:s.projectListDetails,children:[e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"الموقع:"}),e.jsx("span",{className:s.detailValue,children:t.location})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"النوع:"}),e.jsx("span",{className:s.detailValue,children:S[t.type]||t.type})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"عدد الوحدات:"}),e.jsx("span",{className:s.detailValue,children:t.number_of_units??"N/A"})," "]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"الوحدات المباعة:"}),e.jsx("span",{className:s.detailValue,children:t.number_of_sold_items})]}),t.benefits&&e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"المميزات:"}),e.jsx("span",{className:s.detailValue,children:t.benefits})]})]}),e.jsx("div",{children:e.jsxs("a",{href:`/projects/${t.id}?name=${t.name}`,className:s.manageButton,children:[e.jsx(Q,{size:16}),e.jsx("span",{children:"إدارة المشروع"})]})})]})]},t.id))}),u&&e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.modal,children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx("h2",{children:"إضافة مشروع جديد"}),e.jsx("button",{className:s.closeButton,onClick:d,children:e.jsx(R,{size:20})})]}),e.jsxs("form",{onSubmit:ee,className:s.form,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"name",children:"اسم المشروع"}),e.jsx("input",{type:"text",id:"name",value:j,onChange:t=>g(t.target.value),required:!0,placeholder:"أدخل اسم المشروع"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"location",children:"الموقع"}),e.jsx("input",{type:"text",id:"location",value:_,onChange:t=>k(t.target.value),required:!0,placeholder:"أدخل موقع المشروع"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"type",children:"نوع المشروع"}),e.jsx("select",{id:"type",value:N,onChange:t=>y(t.target.value),required:!0,children:Object.entries(S).map(([t,a])=>e.jsx("option",{value:t,children:a},t))})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"numberOfUnits",children:"عدد الوحدات"}),e.jsx("input",{type:"number",id:"numberOfUnits",value:b,onChange:t=>L(t.target.value),required:!0,min:"1",placeholder:"أدخل عدد الوحدات"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"benefits",children:"المميزات"}),e.jsx("textarea",{id:"benefits",value:v,onChange:t=>C(t.target.value),placeholder:"أدخل مميزات أو فوائد المشروع (اختياري)",rows:3})]}),e.jsxs("div",{className:s.formActions,children:[e.jsx("button",{type:"button",className:s.cancelButton,onClick:d,disabled:q,children:"إلغاء"}),e.jsx("button",{type:"submit",className:s.submitButton,disabled:q,children:G?e.jsxs(e.Fragment,{children:[e.jsx(w,{isVisible:!0}),e.jsx("span",{children:"جاري الإنشاء..."})]}):e.jsx("span",{children:"إضافة"})})]})]})]})}),f&&h&&e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.modal,children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx("h2",{children:"تعديل المشروع"}),e.jsx("button",{className:s.closeButton,onClick:d,children:e.jsx(R,{size:20})})]}),e.jsxs("form",{onSubmit:se,className:s.form,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"editName",children:"اسم المشروع"}),e.jsx("input",{type:"text",id:"editName",value:j,onChange:t=>g(t.target.value),required:!0,placeholder:"أدخل اسم المشروع"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"editLocation",children:"الموقع"}),e.jsx("input",{type:"text",id:"editLocation",value:_,onChange:t=>k(t.target.value),required:!0,placeholder:"أدخل موقع المشروع"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"editType",children:"نوع المشروع"}),e.jsx("select",{id:"editType",value:N,onChange:t=>y(t.target.value),required:!0,children:Object.entries(S).map(([t,a])=>e.jsx("option",{value:t,children:a},t))})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"editNumberOfUnits",children:"عدد الوحدات"}),e.jsx("input",{type:"number",id:"editNumberOfUnits",value:b,onChange:t=>L(t.target.value),required:!0,min:"1",placeholder:"أدخل عدد الوحدات"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"editBenefits",children:"المميزات"}),e.jsx("textarea",{id:"editBenefits",value:v,onChange:t=>C(t.target.value),placeholder:"أدخل مميزات أو فوائد المشروع (اختياري)",rows:3})]}),e.jsxs("div",{className:s.formActions,children:[e.jsx("button",{type:"button",className:s.cancelButton,onClick:d,disabled:q,children:"إلغاء"}),e.jsx("button",{type:"submit",className:s.submitButton,disabled:q,children:O?e.jsxs(e.Fragment,{children:[e.jsx(w,{isVisible:!0}),e.jsx("span",{children:"جاري التحديث..."})]}):e.jsx("span",{children:"تحديث"})})]})]})]})}),c&&h&&e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.confirmModal,children:[e.jsx("h2",{children:"تأكيد الحذف"}),e.jsxs("p",{children:['هل أنت متأكد من رغبتك في حذف المشروع "',h.name,'"؟',e.jsx("br",{}),"هذا الإجراء لا يمكن التراجع عنه."]}),e.jsxs("div",{className:s.confirmActions,children:[e.jsx("button",{className:s.cancelButton,onClick:d,disabled:B,children:"إلغاء"}),e.jsx("button",{className:s.deleteConfirmButton,onClick:te,disabled:B,children:B?e.jsxs(e.Fragment,{children:[e.jsx(w,{isVisible:!0}),e.jsx("span",{children:"جاري الحذف..."})]}):e.jsx("span",{children:"تأكيد الحذف"})})]})]})})]})};export{os as default};
