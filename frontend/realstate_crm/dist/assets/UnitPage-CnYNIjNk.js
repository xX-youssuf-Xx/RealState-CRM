import{c as re,r as d,R as ye,j as e,e as ke,y as B,L as Z,a as ge}from"./index-D92RPh5s.js";import{P as ne}from"./ReactToastify-DRkfWm2m.js";import{u as Ie,a as Le}from"./useUpdateUnit-CiV6tZJW.js";import{c as H,X as D}from"./x-gOlHSJ9C.js";import{C as Ce}from"./chevron-right-BjNICrF8.js";import{S as Pe,G as Be,L as Se}from"./search-S0xTPVAL.js";import{F as Fe}from"./funnel-DIFQ4LQq.js";import{I as ie}from"./info-BUaXF49v.js";import{T as le,S as Ue}from"./trash-2-glnfnrzC.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ve=H("chevron-left",Ae);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 11 5 3-5 3v-6Z",key:"7ntvm4"}]],Ee=H("file-video",Me);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],Ge=H("play",Oe);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],$e=H("upload",De),He=()=>{const{isLoading:i,error:m,data:f,setError:v,_execute:w}=re(),N=d.useCallback(async(x,l)=>{try{const r=new FormData;return Object.entries(x).forEach(([I,C])=>{C!=null&&r.append(I,String(C))}),l&&l.length>0&&l.forEach(I=>{r.append("media_files",I)}),await w("units","POST",r,{headers:{}})}catch(r){throw v(r),r}},[w,v]);return{isLoading:i,error:m,data:f,execute:N,setError:v}},Re=()=>{const{isLoading:i,error:m,data:f,setError:v,_execute:w}=re(),N=d.useCallback(async(x,l={})=>{try{return await w(`units/${x}`,"DELETE",null,l)}catch(r){throw v(r),r}},[w,v]);return{isLoading:i,error:m,data:f,execute:N,setError:v}},E={AVAILABLE:"متاح",RESERVED:"محجوز",SOLD:"مباع"},O={CASH:"كاش",INSTALLMENT:"تقسيط",BANK_FINANCING:"تمويل بنكي"},Te="_unitsPage_wua6k_1",ze="_header_wua6k_11",qe="_titleContainer_wua6k_25",We="_title_wua6k_25",Qe="_projectName_wua6k_47",Ke="_headerActions_wua6k_59",Ye="_searchContainer_wua6k_71",Ze="_searchIcon_wua6k_81",Xe="_searchInput_wua6k_97",Je="_viewToggle_wua6k_127",ea="_viewButton_wua6k_141",aa="_activeView_wua6k_175",ta="_filterButton_wua6k_195",sa="_filterBadge_wua6k_233",na="_addButton_wua6k_253",ia="_filterIndicator_wua6k_299",la="_resetButton_wua6k_319",oa="_emptyState_wua6k_349",ra="_unitsGrid_wua6k_377",ca="_unitsList_wua6k_391",da="_unitListItem_wua6k_403",ma="_availableListItem_wua6k_433",ua="_reservedListItem_wua6k_441",ha="_soldListItem_wua6k_449",_a="_unitListHeader_wua6k_457",pa="_unitListContent_wua6k_471",xa="_unitListDetails_wua6k_483",ja="_unitCard_wua6k_495",fa="_availableUnit_wua6k_523",va="_reservedUnit_wua6k_531",wa="_soldUnit_wua6k_539",Na="_unitHeader_wua6k_549",ba="_availableHeader_wua6k_567",ya="_reservedHeader_wua6k_575",ka="_soldHeader_wua6k_583",ga="_unitName_wua6k_591",Ia="_actions_wua6k_603",La="_editButton_wua6k_613",Ca="_deleteButton_wua6k_615",Pa="_infoButton_wua6k_617",Ba="_unitDetails_wua6k_661",Sa="_detailItem_wua6k_669",Fa="_detailLabel_wua6k_691",Ua="_detailValue_wua6k_701",Aa="_availableStatus_wua6k_711",Va="_reservedStatus_wua6k_721",Ma="_soldStatus_wua6k_731",Ea="_modalOverlay_wua6k_743",Oa="_modal_wua6k_743",Ga="_modalHeader_wua6k_791",Da="_closeButton_wua6k_825",$a="_form_wua6k_853",Ha="_filterForm_wua6k_855",Ra="_formGroup_wua6k_863",Ta="_formGroupRow_wua6k_871",za="_formGroupHalf_wua6k_883",qa="_formActions_wua6k_953",Wa="_filterActions_wua6k_955",Qa="_cancelButton_wua6k_969",Ka="_submitButton_wua6k_1011",Ya="_applyFilterButton_wua6k_1013",Za="_resetFilterButton_wua6k_1067",Xa="_infoContent_wua6k_1099",Ja="_infoSection_wua6k_1111",et="_sectionTitle_wua6k_1127",at="_infoItem_wua6k_1143",tt="_infoLabel_wua6k_1163",st="_infoValue_wua6k_1175",nt="_notesBox_wua6k_1183",it="_infoActions_wua6k_1199",lt="_closeInfoButton_wua6k_1213",ot="_editInfoButton_wua6k_1215",rt="_confirmModal_wua6k_1249",ct="_confirmActions_wua6k_1293",dt="_deleteConfirmButton_wua6k_1305",mt="_mediaSection_wua6k_1357",ut="_mediaGallery_wua6k_1365",ht="_mediaItem_wua6k_1379",_t="_mediaImage_wua6k_1405",pt="_mediaVideo_wua6k_1417",xt="_videoIcon_wua6k_1429",jt="_mediaPreviewOverlay_wua6k_1451",ft="_mediaPreviewContent_wua6k_1477",vt="_mediaPreviewImage_wua6k_1489",wt="_mediaPreviewVideo_wua6k_1501",Nt="_mediaPreviewClose_wua6k_1511",bt="_mediaPreviewNav_wua6k_1533",yt="_mediaPreviewPrev_wua6k_1565",kt="_mediaPreviewNext_wua6k_1573",gt="_mediaUploadSection_wua6k_1581",It="_mediaUploadLabel_wua6k_1597",Lt="_mediaUploadInput_wua6k_1609",Ct="_mediaUploadButton_wua6k_1617",Pt="_mediaPreview_wua6k_1451",Bt="_mediaPreviewItem_wua6k_1667",St="_mediaPreviewRemove_wua6k_1685",Ft="_mediaUploadProgress_wua6k_1719",Ut="_mediaUploadProgressBar_wua6k_1735",At="_mediaUploadError_wua6k_1747",Vt="_paymentSection_wua6k_1761",Mt="_paymentMethod_wua6k_1769",Et="_paymentMethodOption_wua6k_1781",Ot="_paymentMethodRadio_wua6k_1791",Gt="_paymentMethodLabel_wua6k_1799",Dt="_paymentDetails_wua6k_1831",$t="_filterPaymentMethod_wua6k_1845",a={unitsPage:Te,header:ze,titleContainer:qe,title:We,projectName:Qe,headerActions:Ke,searchContainer:Ye,searchIcon:Ze,searchInput:Xe,viewToggle:Je,viewButton:ea,activeView:aa,filterButton:ta,filterBadge:sa,addButton:na,filterIndicator:ia,resetButton:la,emptyState:oa,unitsGrid:ra,unitsList:ca,unitListItem:da,availableListItem:ma,reservedListItem:ua,soldListItem:ha,unitListHeader:_a,unitListContent:pa,unitListDetails:xa,unitCard:ja,availableUnit:fa,reservedUnit:va,soldUnit:wa,unitHeader:Na,availableHeader:ba,reservedHeader:ya,soldHeader:ka,unitName:ga,actions:Ia,editButton:La,deleteButton:Ca,infoButton:Pa,unitDetails:Ba,detailItem:Sa,detailLabel:Fa,detailValue:Ua,availableStatus:Aa,reservedStatus:Va,soldStatus:Ma,modalOverlay:Ea,modal:Oa,modalHeader:Ga,closeButton:Da,form:$a,filterForm:Ha,formGroup:Ra,formGroupRow:Ta,formGroupHalf:za,formActions:qa,filterActions:Wa,cancelButton:Qa,submitButton:Ka,applyFilterButton:Ya,resetFilterButton:Za,infoContent:Xa,infoSection:Ja,sectionTitle:et,infoItem:at,infoLabel:tt,infoValue:st,notesBox:nt,infoActions:it,closeInfoButton:lt,editInfoButton:ot,confirmModal:rt,confirmActions:ct,deleteConfirmButton:dt,mediaSection:mt,mediaGallery:ut,mediaItem:ht,mediaImage:_t,mediaVideo:pt,videoIcon:xt,mediaPreviewOverlay:jt,mediaPreviewContent:ft,mediaPreviewImage:vt,mediaPreviewVideo:wt,mediaPreviewClose:Nt,mediaPreviewNav:bt,mediaPreviewPrev:yt,mediaPreviewNext:kt,mediaUploadSection:gt,mediaUploadLabel:It,mediaUploadInput:Lt,mediaUploadButton:Ct,mediaPreview:Pt,mediaPreviewItem:Bt,mediaPreviewRemove:St,mediaUploadProgress:Ft,mediaUploadProgressBar:Ut,mediaUploadError:At,paymentSection:Vt,paymentMethod:Mt,paymentMethodOption:Et,paymentMethodRadio:Ot,paymentMethodLabel:Gt,paymentDetails:Dt,filterPaymentMethod:$t},Ht=({mediaUrls:i})=>{const[m,f]=d.useState(null),v=l=>l.toLowerCase().endsWith(".mp4")||l.toLowerCase().endsWith(".webm")||l.toLowerCase().endsWith(".mov"),w=l=>{f(l)},N=()=>{f(null)},x=l=>{m===null||i.length<=1||f(l==="prev"?r=>r===0?i.length-1:r-1:r=>r===i.length-1?0:r+1)};return ye.useEffect(()=>{const l=r=>{m!==null&&(r.key==="Escape"?N():r.key==="ArrowLeft"?x("prev"):r.key==="ArrowRight"&&x("next"))};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[m]),!i||i.length===0?e.jsx("p",{children:"لا توجد وسائط متاحة"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:a.mediaGallery,children:i.map((l,r)=>e.jsx("div",{className:a.mediaItem,onClick:()=>w(r),children:v(l)?e.jsxs(e.Fragment,{children:[e.jsxs("video",{className:a.mediaVideo,src:l,preload:"metadata",children:[e.jsx("source",{src:l}),"متصفحك لا يدعم تشغيل الفيديو"]}),e.jsx("div",{className:a.videoIcon,children:e.jsx(Ge,{size:24})})]}):e.jsx("img",{className:a.mediaImage,src:"https://amaar.egypt-tech.com"+l||"/placeholder.svg",alt:`صورة ${r+1}`})},r))}),m!==null&&e.jsx("div",{className:a.mediaPreviewOverlay,onClick:N,children:e.jsxs("div",{className:a.mediaPreviewContent,onClick:l=>l.stopPropagation(),children:[v(i[m])?e.jsxs("video",{className:a.mediaPreviewVideo,src:i[m],controls:!0,autoPlay:!0,children:[e.jsx("source",{src:"https://amaar.egypt-tech.com"+i[m]}),"متصفحك لا يدعم تشغيل الفيديو"]}):e.jsx("img",{className:a.mediaPreviewImage,src:"https://amaar.egypt-tech.com"+i[m]||"/placeholder.svg",alt:`صورة ${m+1}`}),e.jsx("button",{className:a.mediaPreviewClose,onClick:N,"aria-label":"إغلاق",children:e.jsx(D,{size:24})}),i.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:`${a.mediaPreviewNav} ${a.mediaPreviewPrev}`,onClick:l=>{l.stopPropagation(),x("prev")},"aria-label":"السابق",children:e.jsx(Ce,{size:24})}),e.jsx("button",{className:`${a.mediaPreviewNav} ${a.mediaPreviewNext}`,onClick:l=>{l.stopPropagation(),x("next")},"aria-label":"التالي",children:e.jsx(Ve,{size:24})})]})]})})]})},Rt=({onMediaChange:i,initialMedia:m})=>{const[f,v]=d.useState([]),[w,N]=d.useState(m?m.split(",").filter(o=>o.trim()!==""):[]),[x,l]=d.useState(m?m.split(",").filter(o=>o.trim()!=="").map(()=>!0):[]),[r,A]=d.useState(0),[I,C]=d.useState(!1),[V,$]=d.useState(null),P=d.useRef(null),s=o=>{if(o.target.files&&o.target.files.length>0){const u=Array.from(o.target.files),p=u.filter(_=>{const L=_.type.toLowerCase();return L.startsWith("image/")||L.startsWith("video/")});if(p.length!==u.length){$("بعض الملفات غير مدعومة. يرجى تحميل صور أو فيديوهات فقط.");return}else $(null);S();const j=p.map(_=>URL.createObjectURL(_));v(_=>[..._,...p]),N(_=>[..._,...j]),l(_=>[..._,...j.map(()=>!1)]),i([...f,...p],[...w,...j]),P.current&&(P.current.value="")}},S=()=>{C(!0),A(0);const o=setInterval(()=>{A(u=>u>=100?(clearInterval(o),C(!1),100):u+10)},200)},h=o=>{const u=[...f],p=[...w],j=[...x];if(!j[o]){URL.revokeObjectURL(p[o]);const _=j.slice(0,o).filter(L=>!L).length;u.splice(_,1)}p.splice(o,1),j.splice(o,1),v(u),N(p),l(j),i(u,p)},F=o=>typeof o=="string"?[".mp4",".webm",".mov",".avi",".wmv",".flv"].some(u=>o.toLowerCase().endsWith(u)):o.type.startsWith("video/");return d.useEffect(()=>()=>{w.forEach((o,u)=>{x[u]||URL.revokeObjectURL(o)})},[w,x]),e.jsxs("div",{className:a.mediaUploadSection,children:[e.jsx("label",{className:a.mediaUploadLabel,children:"صور ومقاطع فيديو الوحدة"}),e.jsx("input",{type:"file",ref:P,className:a.mediaUploadInput,onChange:s,accept:"image/*,video/*",multiple:!0}),e.jsxs("button",{type:"button",className:a.mediaUploadButton,onClick:()=>{var o;return(o=P.current)==null?void 0:o.click()},disabled:I,children:[e.jsx($e,{size:18}),e.jsx("span",{children:"اختر ملفات"})]}),V&&e.jsx("div",{className:a.mediaUploadError,children:V}),I&&e.jsx("div",{className:a.mediaUploadProgress,children:e.jsx("div",{className:a.mediaUploadProgressBar,style:{width:`${r}%`}})}),w.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"mt-4 mb-2",children:"الوسائط:"}),e.jsx("div",{className:a.mediaPreview,children:w.map((o,u)=>e.jsxs("div",{className:a.mediaPreviewItem,children:[x[u]&&F(o)||!x[u]&&f[x.slice(0,u).filter(p=>!p).length].type.startsWith("video/")?e.jsx("div",{style:{position:"relative",width:"100%",height:"100%"},children:e.jsx(Ee,{size:40,style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}})}):e.jsx("img",{src:"https://amaar.egypt-tech.com"+o,alt:`Media ${u}`,style:{width:"100%",height:"100%",objectFit:"cover"},onError:p=>{var L;p.currentTarget.src="/placeholder.svg";const j=document.createElement("div");j.style.position="relative",j.style.width="100%",j.style.height="100%",(L=p.currentTarget.parentNode)==null||L.replaceChild(j,p.currentTarget);const _=document.createElement("div");_.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>',_.style.position="absolute",_.style.top="50%",_.style.left="50%",_.style.transform="translate(-50%, -50%)",j.appendChild(_)}}),e.jsx("button",{className:a.mediaPreviewRemove,onClick:()=>h(u),"aria-label":"إزالة",type:"button",children:e.jsx(D,{size:12})})]},`media-${u}`))})]})]})},G=i=>{const m=typeof i=="string"?Number.parseFloat(i):i;return new Intl.NumberFormat("ar-EG").format(m)+" جنيه"},X=i=>(typeof i=="string"?Number.parseFloat(i):i).toFixed(1)+" م²",J=i=>{if(!i)return"غير محدد";const m=new Date(i),f={year:"numeric",month:"long",day:"numeric"};return m.toLocaleDateString("ar-EG",f)},Tt=()=>new URLSearchParams(ge().search),oe={status:null,minArea:null,maxArea:null,minPrice:null,maxPrice:null,payment_method:null},es=()=>{const{projectId:i}=ke(),f=Tt().get("name")||"المشروع",[v,w]=d.useState([]),[N,x]=d.useState(""),[l,r]=d.useState(!1),[A,I]=d.useState(!1),[C,V]=d.useState(!1),[$,P]=d.useState(!1),[s,S]=d.useState(null),[h,F]=d.useState(oe),[o,u]=d.useState(!1),[p,j]=d.useState("cards"),[_,L]=d.useState([]),[c,M]=d.useState({name:"",area:"",price:"",unit_notes:"",status:"AVAILABLE",sold_date:null,payment_method:null,down_payment:null,installment_amount:null,number_of_installments:null,media:null}),{execute:ce,isLoading:ee}=Ie(),{execute:de,isLoading:R}=He(),{execute:me,isLoading:T}=Le(),{execute:ue,isLoading:z}=Re();d.useEffect(()=>{i&&q()},[i]);const q=async()=>{if(i)try{const t=await ce(Number(i));w(t)}catch(t){B.error(t.message||"حدث خطأ أثناء تحميل بيانات الوحدات")}},W=d.useMemo(()=>{let t=v.filter(n=>n.name.toLowerCase().includes(N.toLowerCase()));return h.status&&(t=t.filter(n=>n.status===h.status)),h.minArea!==null&&(t=t.filter(n=>Number.parseFloat(n.area)>=(h.minArea||0))),h.maxArea!==null&&(t=t.filter(n=>Number.parseFloat(n.area)<=(h.maxArea||Number.POSITIVE_INFINITY))),h.minPrice!==null&&(t=t.filter(n=>Number.parseFloat(n.price)>=(h.minPrice||0))),h.maxPrice!==null&&(t=t.filter(n=>Number.parseFloat(n.price)<=(h.maxPrice||Number.POSITIVE_INFINITY))),h.payment_method&&(t=t.filter(n=>n.payment_method===h.payment_method)),t.sort((n,b)=>n.name.localeCompare(b.name))},[v,N,h]),k=t=>{const{name:n,value:b}=t.target;if(n==="status"&&b==="SOLD"&&!c.sold_date){const y=new Date().toISOString().split("T")[0];M(Y=>({...Y,[n]:b,sold_date:y}))}else M(n==="status"&&b!=="SOLD"?y=>({...y,[n]:b,sold_date:null}):y=>({...y,[n]:b}))},he=t=>{L(t)},U=t=>{const{name:n,value:b}=t.target;if(n==="status")F(y=>({...y,[n]:b||null}));else if(n==="payment_method")F(y=>({...y,[n]:b||null}));else{const y=b?Number.parseFloat(b):null;F(Y=>({...Y,[n]:y}))}},_e=t=>{x(t.target.value)},ae=()=>{S(null),M({name:"",area:"",price:"",unit_notes:"",status:"AVAILABLE",sold_date:null,payment_method:null,down_payment:null,installment_amount:null,number_of_installments:null,media:null}),r(!0)},te=t=>{S(t),M({name:t.name,area:t.area,price:t.price,unit_notes:t.unit_notes||"",status:t.status||"AVAILABLE",sold_date:t.sold_date,payment_method:t.payment_method,down_payment:t.down_payment,installment_amount:t.installment_amount,number_of_installments:t.number_of_installments,media:t.media}),r(!0)},Q=t=>{S(t),V(!0)},se=t=>{S(t),I(!0)},pe=()=>{P(!0)},g=()=>{r(!1),I(!1),V(!1),P(!1)},K=()=>{F(oe),u(!1)},xe=()=>{u(Object.values(h).some(t=>t!==null)),g()},je=async t=>{if(t.preventDefault(),!i||!c.name||c.area===""||c.price===""){B.error("يرجى ملء جميع الحقول المطلوبة");return}try{const n={project_id:Number(i),name:c.name,area:Number.parseFloat(c.area),price:Number.parseFloat(c.price),unit_notes:c.unit_notes||void 0,status:c.status,sold_date:c.sold_date,payment_method:c.payment_method,down_payment:c.down_payment?Number.parseFloat(c.down_payment):null,installment_amount:c.installment_amount?Number.parseFloat(c.installment_amount):null,number_of_installments:c.number_of_installments?Number.parseInt(c.number_of_installments):null};s?(await me(Number(s.id),n,_),B.success("تم تحديث بيانات الوحدة بنجاح")):(await de(n,_),B.success("تم إضافة الوحدة بنجاح")),g(),q()}catch(n){B.error(n.message||"حدث خطأ أثناء حفظ بيانات الوحدة")}},fe=async()=>{if(s)try{await ue(Number(s.id)),B.success("تم حذف الوحدة بنجاح"),g(),q()}catch(t){B.error(t.message||"حدث خطأ أثناء حذف الوحدة")}},ve=t=>t==="AVAILABLE"?`${a.unitCard} ${a.availableUnit}`:t==="RESERVED"?`${a.unitCard} ${a.reservedUnit}`:t==="SOLD"?`${a.unitCard} ${a.soldUnit}`:a.unitCard,we=t=>t==="AVAILABLE"?`${a.unitListItem} ${a.availableListItem}`:t==="RESERVED"?`${a.unitListItem} ${a.reservedListItem}`:t==="SOLD"?`${a.unitListItem} ${a.soldListItem}`:a.unitListItem,Ne=t=>t.media&&t.media.trim()!=="",be=t=>t?t.split(",").filter(n=>n.trim()!==""):[];return e.jsxs("div",{className:a.unitsPage,children:[e.jsxs("div",{className:a.header,children:[e.jsxs("div",{className:a.titleContainer,children:[e.jsx("h1",{className:a.title,children:"وحدات المشروع"}),e.jsx("h2",{className:a.projectName,children:f})]}),e.jsxs("div",{className:a.headerActions,children:[e.jsxs("div",{className:a.searchContainer,children:[e.jsx(Pe,{size:18,className:a.searchIcon}),e.jsx("input",{type:"text",placeholder:"بحث بالاسم...",value:N,onChange:_e,className:a.searchInput})]}),e.jsxs("div",{className:a.viewToggle,children:[e.jsx("button",{className:`${a.viewButton} ${p==="cards"?a.activeView:""}`,onClick:()=>j("cards"),"aria-label":"عرض البطاقات",children:e.jsx(Be,{size:18})}),e.jsx("button",{className:`${a.viewButton} ${p==="list"?a.activeView:""}`,onClick:()=>j("list"),"aria-label":"عرض القائمة",children:e.jsx(Se,{size:18})})]}),e.jsxs("button",{className:a.filterButton,onClick:pe,children:[e.jsx(Fe,{size:18}),e.jsx("span",{children:"تصفية"}),o&&e.jsx("span",{className:a.filterBadge})]}),e.jsxs("button",{className:a.addButton,onClick:ae,disabled:ee,children:[e.jsx(ne,{size:18}),e.jsx("span",{children:"إضافة وحدة"})]})]})]}),ee?e.jsx(Z,{isVisible:!0}):W.length===0?e.jsx("div",{className:a.emptyState,children:N||o?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"لا توجد نتائج مطابقة للبحث"}),o&&e.jsx("button",{className:a.resetButton,onClick:K,children:"إعادة ضبط التصفية"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"لا توجد وحدات في هذا المشروع حالياً"}),e.jsxs("button",{className:a.addButton,onClick:ae,children:[e.jsx(ne,{size:18}),e.jsx("span",{children:"إضافة وحدة"})]})]})}):e.jsxs(e.Fragment,{children:[o&&e.jsxs("div",{className:a.filterIndicator,children:[e.jsx("span",{children:"تم تطبيق التصفية"}),e.jsx("button",{className:a.resetButton,onClick:K,children:"إعادة ضبط"})]}),p==="cards"?e.jsx("div",{className:a.unitsGrid,children:W.map(t=>e.jsxs("div",{className:ve(t.status),children:[e.jsxs("div",{className:`${a.unitHeader} ${t.status?a[t.status.toLowerCase()+"Header"]:""}`,children:[e.jsx("h3",{className:a.unitName,children:t.name}),e.jsxs("div",{className:a.actions,children:[e.jsx("button",{className:a.infoButton,onClick:()=>Q(t),"aria-label":"معلومات",children:e.jsx(ie,{size:18})}),e.jsx("button",{className:a.deleteButton,onClick:()=>se(t),"aria-label":"حذف",children:e.jsx(le,{size:18})})]})]}),e.jsxs("div",{className:a.unitDetails,children:[e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"المساحة:"}),e.jsx("span",{className:a.detailValue,children:X(t.area)})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"السعر:"}),e.jsx("span",{className:a.detailValue,children:G(t.price)})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"الحالة:"}),e.jsx("span",{className:`${a.detailValue} ${t.status?a[t.status.toLowerCase()+"Status"]:""}`,children:t.status?E[t.status]:"غير محدد"})]}),t.payment_method&&e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"طريقة الدفع:"}),e.jsx("span",{className:a.detailValue,children:O[t.payment_method]||t.payment_method})]}),Ne(t)&&e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"الوسائط:"}),e.jsx("button",{type:"button",className:a.viewMediaButton,onClick:()=>Q(t),children:"عرض الصور والفيديوهات"})]})]})]},t.id))}):e.jsx("div",{className:a.unitsList,children:W.map(t=>e.jsxs("div",{className:we(t.status),children:[e.jsxs("div",{className:a.unitListHeader,children:[e.jsx("h3",{className:a.unitName,children:t.name}),e.jsxs("div",{className:a.actions,children:[e.jsx("button",{className:a.infoButton,onClick:()=>Q(t),"aria-label":"معلومات",children:e.jsx(ie,{size:18})}),e.jsx("button",{className:a.editButton,onClick:()=>te(t),"aria-label":"تعديل",children:e.jsx(Ue,{size:18})}),e.jsx("button",{className:a.deleteButton,onClick:()=>se(t),"aria-label":"حذف",children:e.jsx(le,{size:18})})]})]}),e.jsx("div",{className:a.unitListContent,children:e.jsxs("div",{className:a.unitListDetails,children:[e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"المساحة:"}),e.jsx("span",{className:a.detailValue,children:X(t.area)})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"السعر:"}),e.jsx("span",{className:a.detailValue,children:G(t.price)})]}),e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"الحالة:"}),e.jsx("span",{className:`${a.detailValue} ${t.status?a[t.status.toLowerCase()+"Status"]:""}`,children:t.status?E[t.status]:"غير محدد"})]}),t.payment_method&&e.jsxs("div",{className:a.detailItem,children:[e.jsx("span",{className:a.detailLabel,children:"طريقة الدفع:"}),e.jsx("span",{className:a.detailValue,children:O[t.payment_method]||t.payment_method})]})]})})]},t.id))})]}),l&&e.jsx("div",{className:a.modalOverlay,children:e.jsxs("div",{className:a.modal,children:[e.jsxs("div",{className:a.modalHeader,children:[e.jsx("h2",{children:s?"تعديل بيانات الوحدة":"إضافة وحدة جديدة"}),e.jsx("button",{className:a.closeButton,onClick:g,children:e.jsx(D,{size:20})})]}),e.jsxs("form",{onSubmit:je,className:a.form,children:[e.jsxs("div",{className:a.formGroup,children:[e.jsx("label",{htmlFor:"name",children:"اسم الوحدة"}),e.jsx("input",{type:"text",id:"name",name:"name",value:c.name,onChange:k,required:!0,placeholder:"أدخل اسم الوحدة"})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsx("label",{htmlFor:"area",children:"المساحة (م²)"}),e.jsx("input",{type:"number",id:"area",name:"area",value:c.area,onChange:k,required:!0,step:"0.1",min:"0",placeholder:"أدخل المساحة"})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsx("label",{htmlFor:"price",children:"السعر (جنيه)"}),e.jsx("input",{type:"number",id:"price",name:"price",value:c.price,onChange:k,required:!0,min:"0",placeholder:"أدخل السعر"})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsx("label",{htmlFor:"status",children:"الحالة"}),e.jsx("select",{id:"status",name:"status",value:c.status,onChange:k,required:!0,children:Object.entries(E).map(([t,n])=>e.jsx("option",{value:t,children:n},t))})]}),c.status==="SOLD"&&e.jsxs("div",{className:a.formGroup,children:[e.jsx("label",{htmlFor:"sold_date",children:"تاريخ البيع"}),e.jsx("input",{type:"date",id:"sold_date",name:"sold_date",value:c.sold_date||"",onChange:k,required:!0})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsx("label",{htmlFor:"payment_method",children:"طريقة الدفع"}),e.jsxs("select",{id:"payment_method",name:"payment_method",value:c.payment_method||"",onChange:k,children:[e.jsx("option",{value:"",children:"اختر طريقة الدفع"}),Object.entries(O).map(([t,n])=>e.jsx("option",{value:t,children:n},t))]})]}),e.jsxs("div",{className:a.formGroupRow,children:[e.jsxs("div",{className:a.formGroupHalf,children:[e.jsx("label",{htmlFor:"down_payment",children:"الدفعة المقدمة (جنيه)"}),e.jsx("input",{type:"number",id:"down_payment",name:"down_payment",value:c.down_payment||"",onChange:k,min:"0",placeholder:"أدخل قيمة الدفعة المقدمة"})]}),e.jsxs("div",{className:a.formGroupHalf,children:[e.jsx("label",{htmlFor:"installment_amount",children:"قيمة القسط (جنيه)"}),e.jsx("input",{type:"number",id:"installment_amount",name:"installment_amount",value:c.installment_amount||"",onChange:k,min:"0",placeholder:"أدخل قيمة القسط"})]})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsx("label",{htmlFor:"number_of_installments",children:"عدد الأقساط"}),e.jsx("input",{type:"number",id:"number_of_installments",name:"number_of_installments",value:c.number_of_installments||"",onChange:k,min:"1",placeholder:"أدخل عدد الأقساط"})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsx("label",{htmlFor:"unit_notes",children:"ملاحظات"}),e.jsx("textarea",{id:"unit_notes",name:"unit_notes",value:c.unit_notes,onChange:k,placeholder:"أدخل ملاحظات (اختياري)",rows:3})]}),e.jsx(Rt,{onMediaChange:he,initialMedia:(s==null?void 0:s.media)||null}),e.jsxs("div",{className:a.formActions,children:[e.jsx("button",{type:"button",className:a.cancelButton,onClick:g,disabled:R||T,children:"إلغاء"}),e.jsx("button",{type:"submit",className:a.submitButton,disabled:R||T,children:R||T?e.jsxs(e.Fragment,{children:[e.jsx(Z,{isVisible:!0}),e.jsx("span",{children:"جاري الحفظ..."})]}):e.jsx("span",{children:s?"تحديث":"إضافة"})})]})]})]})}),C&&s&&e.jsx("div",{className:a.modalOverlay,children:e.jsxs("div",{className:a.modal,children:[e.jsxs("div",{className:`${a.modalHeader} ${s.status?a[s.status.toLowerCase()+"Header"]:""}`,children:[e.jsx("h2",{children:"معلومات الوحدة"}),e.jsx("button",{className:a.closeButton,onClick:g,children:e.jsx(D,{size:20})})]}),e.jsxs("div",{className:a.infoContent,children:[e.jsxs("div",{className:a.infoSection,children:[e.jsx("h3",{className:a.sectionTitle,children:"المعلومات الأساسية"}),e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"الرقم التعريفي:"}),e.jsx("span",{className:a.infoValue,children:s.id})]}),e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"اسم الوحدة:"}),e.jsx("span",{className:a.infoValue,children:s.name})]}),e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"المساحة:"}),e.jsx("span",{className:a.infoValue,children:X(s.area)})]}),e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"السعر:"}),e.jsx("span",{className:a.infoValue,children:G(s.price)})]})]}),e.jsxs("div",{className:a.infoSection,children:[e.jsx("h3",{className:a.sectionTitle,children:"حالة الوحدة"}),e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"الحالة:"}),e.jsx("span",{className:`${a.infoValue} ${s.status?a[s.status.toLowerCase()+"Status"]:""}`,children:s.status?E[s.status]:"غير محدد"})]}),s.status==="SOLD"&&e.jsxs(e.Fragment,{children:[s.sold_date&&e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"تاريخ البيع:"}),e.jsx("span",{className:a.infoValue,children:J(s.sold_date)})]}),s.payment_method&&e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"طريقة الدفع:"}),e.jsx("span",{className:a.infoValue,children:O[s.payment_method]||s.payment_method})]}),s.payment_method==="INSTALLMENT"&&e.jsxs(e.Fragment,{children:[s.down_payment&&e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"الدفعة المقدمة:"}),e.jsx("span",{className:a.infoValue,children:G(s.down_payment)})]}),s.installment_amount&&e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"قيمة القسط:"}),e.jsx("span",{className:a.infoValue,children:G(s.installment_amount)})]}),s.number_of_installments&&e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"عدد الأقساط:"}),e.jsx("span",{className:a.infoValue,children:s.number_of_installments})]})]})]})]}),s.media&&s.media.trim()!==""&&e.jsxs("div",{className:a.infoSection,children:[e.jsx("h3",{className:a.sectionTitle,children:"الصور والفيديوهات"}),e.jsx(Ht,{mediaUrls:be(s.media)})]}),e.jsxs("div",{className:a.infoSection,children:[e.jsx("h3",{className:a.sectionTitle,children:"معلومات إضافية"}),e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"تاريخ الإنشاء:"}),e.jsx("span",{className:a.infoValue,children:J(s.created_at)})]}),e.jsxs("div",{className:a.infoItem,children:[e.jsx("span",{className:a.infoLabel,children:"آخر تحديث:"}),e.jsx("span",{className:a.infoValue,children:J(s.updated_at)})]})]}),s.unit_notes&&e.jsxs("div",{className:a.infoSection,children:[e.jsx("h3",{className:a.sectionTitle,children:"ملاحظات"}),e.jsx("div",{className:a.notesBox,children:s.unit_notes})]})]}),e.jsxs("div",{className:a.infoActions,children:[e.jsx("button",{className:a.closeInfoButton,onClick:g,children:"إغلاق"}),e.jsx("button",{className:a.editInfoButton,onClick:()=>{g(),te(s)},children:"تعديل"})]})]})}),$&&e.jsx("div",{className:a.modalOverlay,children:e.jsxs("div",{className:a.modal,children:[e.jsxs("div",{className:a.modalHeader,children:[e.jsx("h2",{children:"تصفية الوحدات"}),e.jsx("button",{className:a.closeButton,onClick:g,children:e.jsx(D,{size:20})})]}),e.jsxs("div",{className:a.filterForm,children:[e.jsxs("div",{className:a.formGroup,children:[e.jsx("label",{htmlFor:"status",children:"الحالة"}),e.jsxs("select",{id:"status",name:"status",value:h.status||"",onChange:U,children:[e.jsx("option",{value:"",children:"الكل"}),Object.entries(E).map(([t,n])=>e.jsx("option",{value:t,children:n},t))]})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsx("label",{htmlFor:"payment_method",children:"طريقة الدفع"}),e.jsxs("select",{id:"payment_method",name:"payment_method",value:h.payment_method||"",onChange:U,children:[e.jsx("option",{value:"",children:"الكل"}),Object.entries(O).map(([t,n])=>e.jsx("option",{value:t,children:n},t))]})]}),e.jsxs("div",{className:a.formGroupRow,children:[e.jsxs("div",{className:a.formGroupHalf,children:[e.jsx("label",{htmlFor:"minArea",children:"المساحة (من)"}),e.jsx("input",{type:"number",id:"minArea",name:"minArea",value:h.minArea||"",onChange:U,min:"0",step:"0.1",placeholder:"أقل مساحة"})]}),e.jsxs("div",{className:a.formGroupHalf,children:[e.jsx("label",{htmlFor:"maxArea",children:"المساحة (إلى)"}),e.jsx("input",{type:"number",id:"maxArea",name:"maxArea",value:h.maxArea||"",onChange:U,min:"0",step:"0.1",placeholder:"أكبر مساحة"})]})]}),e.jsxs("div",{className:a.formGroupRow,children:[e.jsxs("div",{className:a.formGroupHalf,children:[e.jsx("label",{htmlFor:"minPrice",children:"السعر (من)"}),e.jsx("input",{type:"number",id:"minPrice",name:"minPrice",value:h.minPrice||"",onChange:U,min:"0",placeholder:"أقل سعر"})]}),e.jsxs("div",{className:a.formGroupHalf,children:[e.jsx("label",{htmlFor:"maxPrice",children:"السعر (إلى)"}),e.jsx("input",{type:"number",id:"maxPrice",name:"maxPrice",value:h.maxPrice||"",onChange:U,min:"0",placeholder:"أكبر سعر"})]})]}),e.jsxs("div",{className:a.filterActions,children:[e.jsx("button",{type:"button",className:a.resetFilterButton,onClick:K,children:"إعادة ضبط"}),e.jsx("button",{type:"button",className:a.applyFilterButton,onClick:xe,children:"تطبيق"})]})]})]})}),A&&s&&e.jsx("div",{className:a.modalOverlay,children:e.jsxs("div",{className:a.confirmModal,children:[e.jsx("h2",{children:"تأكيد الحذف"}),e.jsxs("p",{children:['هل أنت متأكد من رغبتك في حذف الوحدة "',s.name,'"؟',e.jsx("br",{}),"هذا الإجراء لا يمكن التراجع عنه."]}),e.jsxs("div",{className:a.confirmActions,children:[e.jsx("button",{className:a.cancelButton,onClick:g,disabled:z,children:"إلغاء"}),e.jsx("button",{className:a.deleteConfirmButton,onClick:fe,disabled:z,children:z?e.jsxs(e.Fragment,{children:[e.jsx(Z,{isVisible:!0}),e.jsx("span",{children:"جاري الحذف..."})]}):e.jsx("span",{children:"تأكيد الحذف"})})]})]})})]})};export{es as default};
