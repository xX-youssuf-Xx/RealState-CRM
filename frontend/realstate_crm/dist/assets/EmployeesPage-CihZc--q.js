import{c as S,r,y as N,j as e,L as A}from"./index-BAQHcCZP.js";import{S as O,T as P}from"./ReactToastify-Dt8Kh541.js";import{u as re}from"./useGetAllEmployees-DQF5acp6.js";import{S as ie,G as ce,L as de}from"./search-Dfyka3uh.js";import{P as U}from"./plus-2IGcsAYH.js";import{I as F}from"./info-OoKR4taG.js";import{X as q}from"./x-Br0VJ280.js";const me=()=>{const{isLoading:c,error:m,data:i,setError:o,_execute:d}=S(),u=r.useCallback(async(v,h,_,f,a,x={})=>{try{return await d("employees","POST",{name:v,number:h,role:_,notes:f,password:a},x)}catch(n){throw o(n),n}},[d,o]);return{isLoading:c,error:m,data:i,execute:u,setError:o}},ue=()=>{const{isLoading:c,error:m,data:i,setError:o,_execute:d}=S(),u=r.useCallback(async(v,h,_,f,a,x,n={})=>{try{const p={name:h,number:_,role:f,notes:a,password:x};return await d(`employees/${v}`,"PATCH",p,n)}catch(p){throw o(p),p}},[d,o]);return{isLoading:c,error:m,data:i,execute:u,setError:o}},_e=()=>{const{isLoading:c,error:m,data:i,setError:o,_execute:d}=S(),u=r.useCallback(async(v,h={})=>{try{return await d(`employees/${v}`,"DELETE",null,h)}catch(_){throw o(_),_}},[d,o]);return{isLoading:c,error:m,data:i,execute:u,setError:o}},pe="_employeesPage_1tvkr_1",he="_header_1tvkr_11",xe="_title_1tvkr_25",ve="_headerActions_1tvkr_37",je="_searchContainer_1tvkr_49",fe="_searchIcon_1tvkr_59",Ne="_searchInput_1tvkr_75",ye="_viewToggle_1tvkr_105",Le="_viewButton_1tvkr_119",be="_activeView_1tvkr_153",ke="_addButton_1tvkr_173",Ce="_emptyState_1tvkr_219",Ee="_employeesGrid_1tvkr_247",Ie="_employeesList_1tvkr_261",ge="_employeeListItem_1tvkr_273",Be="_employeeListHeader_1tvkr_301",we="_employeeListContent_1tvkr_315",Ae="_employeeListDetails_1tvkr_327",De="_employeeCard_1tvkr_339",Se="_adminEmployee_1tvkr_367",$e="_managerEmployee_1tvkr_375",He="_salesEmployee_1tvkr_383",Me="_deletedEmployee_1tvkr_391",Ve="_adminListItem_1tvkr_415",Re="_managerListItem_1tvkr_423",Ge="_salesListItem_1tvkr_431",Te="_deletedListItem_1tvkr_439",ze="_employeeHeader_1tvkr_463",Oe="_adminHeader_1tvkr_481",Pe="_managerHeader_1tvkr_491",Ue="_salesHeader_1tvkr_499",Fe="_deletedHeader_1tvkr_507",qe="_employeeName_1tvkr_515",Qe="_actions_1tvkr_527",Xe="_editButton_1tvkr_537",Je="_deleteButton_1tvkr_539",Ke="_infoButton_1tvkr_541",We="_employeeDetails_1tvkr_607",Ye="_detailItem_1tvkr_615",Ze="_detailLabel_1tvkr_637",es="_detailValue_1tvkr_647",ss="_adminRole_1tvkr_657",ts="_managerRole_1tvkr_667",as="_salesRole_1tvkr_677",ns="_deletedRole_1tvkr_687",ls="_modalOverlay_1tvkr_699",os="_modal_1tvkr_699",rs="_modalHeader_1tvkr_747",is="_closeButton_1tvkr_781",cs="_form_1tvkr_825",ds="_formGroup_1tvkr_833",ms="_formActions_1tvkr_893",us="_cancelButton_1tvkr_907",_s="_submitButton_1tvkr_949",ps="_infoContent_1tvkr_1001",hs="_infoItem_1tvkr_1009",xs="_infoLabel_1tvkr_1021",vs="_infoValue_1tvkr_1033",js="_infoActions_1tvkr_1041",fs="_closeInfoButton_1tvkr_1053",Ns="_confirmModal_1tvkr_1085",ys="_confirmActions_1tvkr_1129",Ls="_deleteConfirmButton_1tvkr_1141",s={employeesPage:pe,header:he,title:xe,headerActions:ve,searchContainer:je,searchIcon:fe,searchInput:Ne,viewToggle:ye,viewButton:Le,activeView:be,addButton:ke,emptyState:Ce,employeesGrid:Ee,employeesList:Ie,employeeListItem:ge,employeeListHeader:Be,employeeListContent:we,employeeListDetails:Ae,employeeCard:De,adminEmployee:Se,managerEmployee:$e,salesEmployee:He,deletedEmployee:Me,adminListItem:Ve,managerListItem:Re,salesListItem:Ge,deletedListItem:Te,employeeHeader:ze,adminHeader:Oe,managerHeader:Pe,salesHeader:Ue,deletedHeader:Fe,employeeName:qe,actions:Qe,editButton:Xe,deleteButton:Je,infoButton:Ke,employeeDetails:We,detailItem:Ye,detailLabel:Ze,detailValue:es,adminRole:ss,managerRole:ts,salesRole:as,deletedRole:ns,modalOverlay:ls,modal:os,modalHeader:rs,closeButton:is,form:cs,formGroup:ds,formActions:ms,cancelButton:us,submitButton:_s,infoContent:ps,infoItem:hs,infoLabel:xs,infoValue:vs,infoActions:js,closeInfoButton:fs,confirmModal:Ns,confirmActions:ys,deleteConfirmButton:Ls},D={ADMIN:"مدير النظام",SALES:"مبيعات",MANAGER:"مدير",DELETED:"محذوف"},Q={ADMIN:1,MANAGER:2,SALES:3,DELETED:4},k=c=>{const m=new Date(c),i={year:"numeric",month:"long",day:"numeric"};return m.toLocaleDateString("ar-EG",i)},X={name:"",number:"",role:"SALES",notes:"",password:""},ws=()=>{const[c,m]=r.useState([]),[i,o]=r.useState(""),[d,u]=r.useState(!1),[v,h]=r.useState(!1),[_,f]=r.useState(!1),[a,x]=r.useState(null),[n,p]=r.useState(X),[L,$]=r.useState("cards"),{execute:J,isLoading:H}=re(),{execute:K,isLoading:C}=me(),{execute:W,isLoading:E}=ue(),{execute:Y,isLoading:I}=_e();r.useEffect(()=>{g()},[]);const g=async()=>{try{const t=await J();m(t)}catch(t){N.error(t.message||"حدث خطأ أثناء تحميل بيانات الموظفين")}},B=r.useMemo(()=>c.filter(l=>l.name.toLowerCase().includes(i.toLowerCase())).sort((l,b)=>{const w=l.role.toUpperCase(),ne=b.role.toUpperCase(),T=Q[w]||999,z=Q[ne]||999;if(T!==z)return T-z;const le=new Date(l.created_at).getTime(),oe=new Date(b.created_at).getTime();return le-oe}),[c,i]),y=t=>{const{name:l,value:b}=t.target;p(w=>({...w,[l]:b}))},Z=t=>{o(t.target.value)},M=()=>{x(null),p(X),u(!0)},V=t=>{x(t),p({id:t.id.toString(),name:t.name,number:t.number,role:t.role.toUpperCase(),notes:t.notes||"",password:""}),u(!0)},R=t=>{x(t),f(!0)},G=t=>{x(t),h(!0)},j=()=>{u(!1),h(!1),f(!1)},ee=async t=>{t.preventDefault();try{a?(await W(Number(a.id),n.name,n.number,n.role,n.notes,n.password||void 0),N.success("تم تحديث بيانات الموظف بنجاح")):(await K(n.name,n.number,n.role,n.notes,n.password),N.success("تم إضافة الموظف بنجاح")),j(),g()}catch(l){N.error(l.message||"حدث خطأ أثناء حفظ بيانات الموظف")}},se=async()=>{if(a)try{await Y(Number(a.id)),N.success("تم حذف الموظف بنجاح"),j(),g()}catch(t){N.error(t.message||"حدث خطأ أثناء حذف الموظف")}},te=t=>{const l=t.toUpperCase();return l==="DELETED"?`${s.employeeCard} ${s.deletedEmployee}`:l==="ADMIN"?`${s.employeeCard} ${s.adminEmployee}`:l==="MANAGER"?`${s.employeeCard} ${s.managerEmployee}`:l==="SALES"?`${s.employeeCard} ${s.salesEmployee}`:s.employeeCard},ae=t=>{const l=t.toUpperCase();return l==="DELETED"?`${s.employeeListItem} ${s.deletedListItem}`:l==="ADMIN"?`${s.employeeListItem} ${s.adminListItem}`:l==="MANAGER"?`${s.employeeListItem} ${s.managerListItem}`:l==="SALES"?`${s.employeeListItem} ${s.salesListItem}`:s.employeeListItem};return e.jsxs("div",{className:s.employeesPage,children:[e.jsxs("div",{className:s.header,children:[e.jsx("h1",{className:s.title,children:"إدارة الموظفين"}),e.jsxs("div",{className:s.headerActions,children:[e.jsxs("div",{className:s.searchContainer,children:[e.jsx(ie,{size:18,className:s.searchIcon}),e.jsx("input",{type:"text",placeholder:"بحث بالاسم...",value:i,onChange:Z,className:s.searchInput})]}),e.jsxs("div",{className:s.viewToggle,children:[e.jsx("button",{className:`${s.viewButton} ${L==="cards"?s.activeView:""}`,onClick:()=>$("cards"),"aria-label":"عرض البطاقات",children:e.jsx(ce,{size:18})}),e.jsx("button",{className:`${s.viewButton} ${L==="list"?s.activeView:""}`,onClick:()=>$("list"),"aria-label":"عرض القائمة",children:e.jsx(de,{size:18})})]}),e.jsxs("button",{className:s.addButton,onClick:M,disabled:H,children:[e.jsx(U,{size:18}),e.jsx("span",{children:"إضافة موظف"})]})]})]}),H?e.jsx(A,{isVisible:!0}):B.length===0?e.jsx("div",{className:s.emptyState,children:i?e.jsx("p",{children:"لا توجد نتائج مطابقة للبحث"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"لا يوجد موظفين حالياً"}),e.jsxs("button",{className:s.addButton,onClick:M,children:[e.jsx(U,{size:18}),e.jsx("span",{children:"إضافة موظف"})]})]})}):L==="cards"?e.jsx("div",{className:s.employeesGrid,children:B.map(t=>e.jsxs("div",{className:te(t.role),children:[e.jsxs("div",{className:`${s.employeeHeader} ${s[t.role.toLowerCase()+"Header"]}`,children:[e.jsx("h3",{className:s.employeeName,children:t.name}),e.jsxs("div",{className:s.actions,children:[e.jsx("button",{className:s.infoButton,onClick:()=>R(t),"aria-label":"معلومات",children:e.jsx(F,{size:18})}),e.jsx("button",{className:s.editButton,onClick:()=>V(t),"aria-label":"تعديل",children:e.jsx(O,{size:18})}),e.jsx("button",{className:s.deleteButton,onClick:()=>G(t),"aria-label":"حذف",disabled:t.role.toUpperCase()==="DELETED",children:e.jsx(P,{size:18})})]})]}),e.jsxs("div",{className:s.employeeDetails,children:[e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"رقم الهاتف:"}),e.jsx("span",{className:s.detailValue,children:t.number})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"الوظيفة:"}),e.jsx("span",{className:`${s.detailValue} ${s[t.role.toLowerCase()+"Role"]}`,children:D[t.role.toUpperCase()]||t.role})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"تاريخ البدء:"}),e.jsx("span",{className:s.detailValue,children:k(t.created_at.toString())})]})]})]},t.id))}):e.jsx("div",{className:s.employeesList,children:B.map(t=>e.jsxs("div",{className:ae(t.role),children:[e.jsxs("div",{className:s.employeeListHeader,children:[e.jsx("h3",{className:s.employeeName,children:t.name}),e.jsxs("div",{className:s.actions,children:[e.jsx("button",{className:s.infoButton,onClick:()=>R(t),"aria-label":"معلومات",children:e.jsx(F,{size:18})}),e.jsx("button",{className:s.editButton,onClick:()=>V(t),"aria-label":"تعديل",children:e.jsx(O,{size:18})}),e.jsx("button",{className:s.deleteButton,onClick:()=>G(t),"aria-label":"حذف",disabled:t.role.toUpperCase()==="DELETED",children:e.jsx(P,{size:18})})]})]}),e.jsx("div",{className:s.employeeListContent,children:e.jsxs("div",{className:s.employeeListDetails,children:[e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"رقم الهاتف:"}),e.jsx("span",{className:s.detailValue,children:t.number})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"الوظيفة:"}),e.jsx("span",{className:`${s.detailValue} ${s[t.role.toLowerCase()+"Role"]}`,children:D[t.role.toUpperCase()]||t.role})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"تاريخ البدء:"}),e.jsx("span",{className:s.detailValue,children:k(t.created_at.toString())})]})]})})]},t.id))}),d&&e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.modal,children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx("h2",{children:a?"تعديل بيانات الموظف":"إضافة موظف جديد"}),e.jsx("button",{className:s.closeButton,onClick:j,children:e.jsx(q,{size:20})})]}),e.jsxs("form",{onSubmit:ee,className:s.form,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"name",children:"الاسم"}),e.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:y,required:!0,placeholder:"أدخل اسم الموظف"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"number",children:"رقم الهاتف"}),e.jsx("input",{type:"text",id:"number",name:"number",value:n.number,onChange:y,required:!0,placeholder:"أدخل رقم الهاتف"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"role",children:"الوظيفة"}),e.jsxs("select",{id:"role",name:"role",value:n.role,onChange:y,required:!0,children:[e.jsx("option",{value:"ADMIN",children:"مدير النظام"}),e.jsx("option",{value:"MANAGER",children:"مدير"}),e.jsx("option",{value:"SALES",children:"مبيعات"})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"notes",children:"ملاحظات"}),e.jsx("textarea",{id:"notes",name:"notes",value:n.notes,onChange:y,placeholder:"أدخل ملاحظات (اختياري)",rows:3})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"password",children:a?"كلمة المرور (اتركها فارغة إذا لم ترغب في تغييرها)":"كلمة المرور"}),e.jsx("input",{type:"password",id:"password",name:"password",value:n.password,onChange:y,required:!a,placeholder:"أدخل كلمة المرور"})]}),e.jsxs("div",{className:s.formActions,children:[e.jsx("button",{type:"button",className:s.cancelButton,onClick:j,disabled:C||E,children:"إلغاء"}),e.jsx("button",{type:"submit",className:s.submitButton,disabled:C||E,children:C||E?e.jsxs(e.Fragment,{children:[e.jsx(A,{isVisible:!0}),e.jsx("span",{children:"جاري الحفظ..."})]}):e.jsx("span",{children:a?"تحديث":"إضافة"})})]})]})]})}),_&&a&&e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.modal,children:[e.jsxs("div",{className:`${s.modalHeader} ${s[a.role.toLowerCase()+"Header"]}`,children:[e.jsx("h2",{children:"معلومات الموظف"}),e.jsx("button",{className:s.closeButton,onClick:j,children:e.jsx(q,{size:20})})]}),e.jsxs("div",{className:s.infoContent,children:[e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"الرقم التعريفي:"}),e.jsx("span",{className:s.infoValue,children:a.id})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"الاسم:"}),e.jsx("span",{className:s.infoValue,children:a.name})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"رقم الهاتف:"}),e.jsx("span",{className:s.infoValue,children:a.number})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"الوظيفة:"}),e.jsx("span",{className:`${s.infoValue} ${s[a.role.toLowerCase()+"Role"]}`,children:D[a.role.toUpperCase()]||a.role})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"ملاحظات:"}),e.jsx("span",{className:s.infoValue,children:a.notes||"لا توجد ملاحظات"})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"تاريخ البدء:"}),e.jsx("span",{className:s.infoValue,children:k(a.created_at.toString())})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"آخر تحديث:"}),e.jsx("span",{className:s.infoValue,children:k(a.updated_at.toString())})]})]}),e.jsx("div",{className:s.infoActions,children:e.jsx("button",{className:s.closeInfoButton,onClick:j,children:"إغلاق"})})]})}),v&&a&&e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.confirmModal,children:[e.jsx("h2",{children:"تأكيد الحذف"}),e.jsxs("p",{children:['هل أنت متأكد من رغبتك في حذف الموظف "',a.name,'"؟',e.jsx("br",{}),"هذا الإجراء لا يمكن التراجع عنه."]}),e.jsxs("div",{className:s.confirmActions,children:[e.jsx("button",{className:s.cancelButton,onClick:j,disabled:I,children:"إلغاء"}),e.jsx("button",{className:s.deleteConfirmButton,onClick:se,disabled:I,children:I?e.jsxs(e.Fragment,{children:[e.jsx(A,{isVisible:!0}),e.jsx("span",{children:"جاري الحذف..."})]}):e.jsx("span",{children:"تأكيد الحذف"})})]})]})})]})};export{ws as default};
