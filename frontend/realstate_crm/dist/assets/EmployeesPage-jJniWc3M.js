import{c as D,r as i,y as j,j as e,L as A}from"./index-DQLDsJ8x.js";import{S as O,T as P}from"./ReactToastify-D7rqofOa.js";import{u as re}from"./useGetAllEmployees-CPuVglHD.js";import{S as ie,G as ce,L as de}from"./search-BSsPHhU1.js";import{P as U}from"./plus-Cr0sTXto.js";import{I as F}from"./info-ChstEPZ2.js";import{X as q}from"./x-7LzE6r3U.js";const me=()=>{const{isLoading:m,error:u,data:c,setError:d,_execute:p}=D(),_=i.useCallback(async(r,h,l,f,a,v={})=>{try{return await p("employees","POST",{name:r,number:h,role:l,notes:f,password:a},v)}catch(o){throw d(o),o}},[p,d]);return{isLoading:m,error:u,data:c,execute:_,setError:d}},ue=()=>{const{_execute:m,isLoading:u}=D(),[c,d]=i.useState(null);return{execute:i.useCallback(async(_,r,h={})=>{try{const l={};return r.name!==void 0&&(l.name=r.name),r.number!==void 0&&(l.number=r.number),r.role!==void 0&&(l.role=r.role),r.notes!==void 0&&(l.notes=r.notes),r.password!==void 0&&(l.password=r.password),await m(`employees/${_}`,"PATCH",l,h)}catch(l){throw d(l),l}},[m,d]),isLoading:u,error:c}},_e=()=>{const{isLoading:m,error:u,data:c,setError:d,_execute:p}=D(),_=i.useCallback(async(r,h={})=>{try{return await p(`employees/${r}`,"DELETE",null,h)}catch(l){throw d(l),l}},[p,d]);return{isLoading:m,error:u,data:c,execute:_,setError:d}},pe="_employeesPage_1tvkr_1",he="_header_1tvkr_11",xe="_title_1tvkr_25",ve="_headerActions_1tvkr_37",je="_searchContainer_1tvkr_49",fe="_searchIcon_1tvkr_59",Ne="_searchInput_1tvkr_75",ye="_viewToggle_1tvkr_105",be="_viewButton_1tvkr_119",Le="_activeView_1tvkr_153",ke="_addButton_1tvkr_173",Ce="_emptyState_1tvkr_219",Ee="_employeesGrid_1tvkr_247",Ie="_employeesList_1tvkr_261",ge="_employeeListItem_1tvkr_273",we="_employeeListHeader_1tvkr_301",Be="_employeeListContent_1tvkr_315",Ae="_employeeListDetails_1tvkr_327",Se="_employeeCard_1tvkr_339",De="_adminEmployee_1tvkr_367",$e="_managerEmployee_1tvkr_375",He="_salesEmployee_1tvkr_383",Me="_deletedEmployee_1tvkr_391",Ve="_adminListItem_1tvkr_415",Re="_managerListItem_1tvkr_423",Ge="_salesListItem_1tvkr_431",Te="_deletedListItem_1tvkr_439",ze="_employeeHeader_1tvkr_463",Oe="_adminHeader_1tvkr_481",Pe="_managerHeader_1tvkr_491",Ue="_salesHeader_1tvkr_499",Fe="_deletedHeader_1tvkr_507",qe="_employeeName_1tvkr_515",Qe="_actions_1tvkr_527",Xe="_editButton_1tvkr_537",Je="_deleteButton_1tvkr_539",Ke="_infoButton_1tvkr_541",We="_employeeDetails_1tvkr_607",Ye="_detailItem_1tvkr_615",Ze="_detailLabel_1tvkr_637",es="_detailValue_1tvkr_647",ss="_adminRole_1tvkr_657",ts="_managerRole_1tvkr_667",as="_salesRole_1tvkr_677",ns="_deletedRole_1tvkr_687",os="_modalOverlay_1tvkr_699",ls="_modal_1tvkr_699",rs="_modalHeader_1tvkr_747",is="_closeButton_1tvkr_781",cs="_form_1tvkr_825",ds="_formGroup_1tvkr_833",ms="_formActions_1tvkr_893",us="_cancelButton_1tvkr_907",_s="_submitButton_1tvkr_949",ps="_infoContent_1tvkr_1001",hs="_infoItem_1tvkr_1009",xs="_infoLabel_1tvkr_1021",vs="_infoValue_1tvkr_1033",js="_infoActions_1tvkr_1041",fs="_closeInfoButton_1tvkr_1053",Ns="_confirmModal_1tvkr_1085",ys="_confirmActions_1tvkr_1129",bs="_deleteConfirmButton_1tvkr_1141",s={employeesPage:pe,header:he,title:xe,headerActions:ve,searchContainer:je,searchIcon:fe,searchInput:Ne,viewToggle:ye,viewButton:be,activeView:Le,addButton:ke,emptyState:Ce,employeesGrid:Ee,employeesList:Ie,employeeListItem:ge,employeeListHeader:we,employeeListContent:Be,employeeListDetails:Ae,employeeCard:Se,adminEmployee:De,managerEmployee:$e,salesEmployee:He,deletedEmployee:Me,adminListItem:Ve,managerListItem:Re,salesListItem:Ge,deletedListItem:Te,employeeHeader:ze,adminHeader:Oe,managerHeader:Pe,salesHeader:Ue,deletedHeader:Fe,employeeName:qe,actions:Qe,editButton:Xe,deleteButton:Je,infoButton:Ke,employeeDetails:We,detailItem:Ye,detailLabel:Ze,detailValue:es,adminRole:ss,managerRole:ts,salesRole:as,deletedRole:ns,modalOverlay:os,modal:ls,modalHeader:rs,closeButton:is,form:cs,formGroup:ds,formActions:ms,cancelButton:us,submitButton:_s,infoContent:ps,infoItem:hs,infoLabel:xs,infoValue:vs,infoActions:js,closeInfoButton:fs,confirmModal:Ns,confirmActions:ys,deleteConfirmButton:bs},S={ADMIN:"مدير النظام",SALES:"مبيعات",MANAGER:"مدير",DELETED:"محذوف"},Q={ADMIN:1,MANAGER:2,SALES:3,DELETED:4},L=m=>{const u=new Date(m),c={year:"numeric",month:"long",day:"numeric"};return u.toLocaleDateString("ar-EG",c)},X={name:"",number:"",role:"SALES",notes:"",password:""},Bs=()=>{const[m,u]=i.useState([]),[c,d]=i.useState(""),[p,_]=i.useState(!1),[r,h]=i.useState(!1),[l,f]=i.useState(!1),[a,v]=i.useState(null),[o,y]=i.useState(X),[k,$]=i.useState("cards"),{execute:J,isLoading:H}=re(),{execute:K,isLoading:C}=me(),{execute:W,isLoading:E}=ue(),{execute:Y,isLoading:I}=_e();i.useEffect(()=>{g()},[]);const g=async()=>{try{const t=await J();u(t)}catch(t){j.error(t.message||"حدث خطأ أثناء تحميل بيانات الموظفين")}},w=i.useMemo(()=>m.filter(n=>n.name.toLowerCase().includes(c.toLowerCase())).sort((n,b)=>{const B=n.role.toUpperCase(),ne=b.role.toUpperCase(),T=Q[B]||999,z=Q[ne]||999;if(T!==z)return T-z;const oe=new Date(n.created_at).getTime(),le=new Date(b.created_at).getTime();return oe-le}),[m,c]),N=t=>{const{name:n,value:b}=t.target;y(B=>({...B,[n]:b}))},Z=t=>{d(t.target.value)},M=()=>{v(null),y(X),_(!0)},V=t=>{v(t),y({id:t.id.toString(),name:t.name,number:t.number,role:t.role.toUpperCase(),notes:t.notes||"",password:""}),_(!0)},R=t=>{v(t),f(!0)},G=t=>{v(t),h(!0)},x=()=>{_(!1),h(!1),f(!1)},ee=async t=>{t.preventDefault();try{if(a){const n={};o.name!==a.name&&(n.name=o.name),o.number!==a.number&&(n.number=o.number),o.role!==a.role.toUpperCase()&&(n.role=o.role),o.notes!==(a.notes||"")&&(n.notes=o.notes),o.password&&(n.password=o.password),await W(Number(a.id),n),j.success("تم تحديث بيانات الموظف بنجاح")}else await K(o.name,o.number,o.role,o.notes,o.password),j.success("تم إضافة الموظف بنجاح");x(),g()}catch(n){j.error(n.message||"حدث خطأ أثناء حفظ بيانات الموظف")}},se=async()=>{if(a)try{await Y(Number(a.id)),j.success("تم حذف الموظف بنجاح"),x(),g()}catch(t){j.error(t.message||"حدث خطأ أثناء حذف الموظف")}},te=t=>{const n=t.toUpperCase();return n==="DELETED"?`${s.employeeCard} ${s.deletedEmployee}`:n==="ADMIN"?`${s.employeeCard} ${s.adminEmployee}`:n==="MANAGER"?`${s.employeeCard} ${s.managerEmployee}`:n==="SALES"?`${s.employeeCard} ${s.salesEmployee}`:s.employeeCard},ae=t=>{const n=t.toUpperCase();return n==="DELETED"?`${s.employeeListItem} ${s.deletedListItem}`:n==="ADMIN"?`${s.employeeListItem} ${s.adminListItem}`:n==="MANAGER"?`${s.employeeListItem} ${s.managerListItem}`:n==="SALES"?`${s.employeeListItem} ${s.salesListItem}`:s.employeeListItem};return e.jsxs("div",{className:s.employeesPage,children:[e.jsxs("div",{className:s.header,children:[e.jsx("h1",{className:s.title,children:"إدارة الموظفين"}),e.jsxs("div",{className:s.headerActions,children:[e.jsxs("div",{className:s.searchContainer,children:[e.jsx(ie,{size:18,className:s.searchIcon}),e.jsx("input",{type:"text",placeholder:"بحث بالاسم...",value:c,onChange:Z,className:s.searchInput})]}),e.jsxs("div",{className:s.viewToggle,children:[e.jsx("button",{className:`${s.viewButton} ${k==="cards"?s.activeView:""}`,onClick:()=>$("cards"),"aria-label":"عرض البطاقات",children:e.jsx(ce,{size:18})}),e.jsx("button",{className:`${s.viewButton} ${k==="list"?s.activeView:""}`,onClick:()=>$("list"),"aria-label":"عرض القائمة",children:e.jsx(de,{size:18})})]}),e.jsxs("button",{className:s.addButton,onClick:M,disabled:H,children:[e.jsx(U,{size:18}),e.jsx("span",{children:"إضافة موظف"})]})]})]}),H?e.jsx(A,{isVisible:!0}):w.length===0?e.jsx("div",{className:s.emptyState,children:c?e.jsx("p",{children:"لا توجد نتائج مطابقة للبحث"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"لا يوجد موظفين حالياً"}),e.jsxs("button",{className:s.addButton,onClick:M,children:[e.jsx(U,{size:18}),e.jsx("span",{children:"إضافة موظف"})]})]})}):k==="cards"?e.jsx("div",{className:s.employeesGrid,children:w.map(t=>e.jsxs("div",{className:te(t.role),children:[e.jsxs("div",{className:`${s.employeeHeader} ${s[t.role.toLowerCase()+"Header"]}`,children:[e.jsx("h3",{className:s.employeeName,children:t.name}),e.jsxs("div",{className:s.actions,children:[e.jsx("button",{className:s.infoButton,onClick:()=>R(t),"aria-label":"معلومات",children:e.jsx(F,{size:18})}),e.jsx("button",{className:s.editButton,onClick:()=>V(t),"aria-label":"تعديل",children:e.jsx(O,{size:18})}),e.jsx("button",{className:s.deleteButton,onClick:()=>G(t),"aria-label":"حذف",disabled:t.role.toUpperCase()==="DELETED",children:e.jsx(P,{size:18})})]})]}),e.jsxs("div",{className:s.employeeDetails,children:[e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"رقم الهاتف:"}),e.jsx("span",{className:s.detailValue,children:t.number})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"الوظيفة:"}),e.jsx("span",{className:`${s.detailValue} ${s[t.role.toLowerCase()+"Role"]}`,children:S[t.role.toUpperCase()]||t.role})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"تاريخ البدء:"}),e.jsx("span",{className:s.detailValue,children:L(t.created_at.toString())})]})]})]},t.id))}):e.jsx("div",{className:s.employeesList,children:w.map(t=>e.jsxs("div",{className:ae(t.role),children:[e.jsxs("div",{className:s.employeeListHeader,children:[e.jsx("h3",{className:s.employeeName,children:t.name}),e.jsxs("div",{className:s.actions,children:[e.jsx("button",{className:s.infoButton,onClick:()=>R(t),"aria-label":"معلومات",children:e.jsx(F,{size:18})}),e.jsx("button",{className:s.editButton,onClick:()=>V(t),"aria-label":"تعديل",children:e.jsx(O,{size:18})}),e.jsx("button",{className:s.deleteButton,onClick:()=>G(t),"aria-label":"حذف",disabled:t.role.toUpperCase()==="DELETED",children:e.jsx(P,{size:18})})]})]}),e.jsx("div",{className:s.employeeListContent,children:e.jsxs("div",{className:s.employeeListDetails,children:[e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"رقم الهاتف:"}),e.jsx("span",{className:s.detailValue,children:t.number})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"الوظيفة:"}),e.jsx("span",{className:`${s.detailValue} ${s[t.role.toLowerCase()+"Role"]}`,children:S[t.role.toUpperCase()]||t.role})]}),e.jsxs("div",{className:s.detailItem,children:[e.jsx("span",{className:s.detailLabel,children:"تاريخ البدء:"}),e.jsx("span",{className:s.detailValue,children:L(t.created_at.toString())})]})]})})]},t.id))}),p&&e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.modal,children:[e.jsxs("div",{className:s.modalHeader,children:[e.jsx("h2",{children:a?"تعديل بيانات الموظف":"إضافة موظف جديد"}),e.jsx("button",{className:s.closeButton,onClick:x,children:e.jsx(q,{size:20})})]}),e.jsxs("form",{onSubmit:ee,className:s.form,children:[e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"name",children:"الاسم"}),e.jsx("input",{type:"text",id:"name",name:"name",value:o.name,onChange:N,required:!0,placeholder:"أدخل اسم الموظف"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"number",children:"رقم الهاتف"}),e.jsx("input",{type:"number",id:"number",name:"number",value:o.number,onChange:N,required:!0,placeholder:"أدخل رقم الهاتف"})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"role",children:"الوظيفة"}),e.jsxs("select",{id:"role",name:"role",value:o.role,onChange:N,required:!0,children:[e.jsx("option",{value:"ADMIN",children:"مدير النظام"}),e.jsx("option",{value:"MANAGER",children:"مدير"}),e.jsx("option",{value:"SALES",children:"مبيعات"})]})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"notes",children:"ملاحظات"}),e.jsx("textarea",{id:"notes",name:"notes",value:o.notes,onChange:N,placeholder:"أدخل ملاحظات (اختياري)",rows:3})]}),e.jsxs("div",{className:s.formGroup,children:[e.jsx("label",{htmlFor:"password",children:a?"كلمة المرور (اتركها فارغة إذا لم ترغب في تغييرها)":"كلمة المرور"}),e.jsx("input",{type:"password",id:"password",name:"password",value:o.password,onChange:N,required:!a,placeholder:"أدخل كلمة المرور"})]}),e.jsxs("div",{className:s.formActions,children:[e.jsx("button",{type:"button",className:s.cancelButton,onClick:x,disabled:C||E,children:"إلغاء"}),e.jsx("button",{type:"submit",className:s.submitButton,disabled:C||E,children:C||E?e.jsxs(e.Fragment,{children:[e.jsx(A,{isVisible:!0}),e.jsx("span",{children:"جاري الحفظ..."})]}):e.jsx("span",{children:a?"تحديث":"إضافة"})})]})]})]})}),l&&a&&e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.modal,children:[e.jsxs("div",{className:`${s.modalHeader} ${s[a.role.toLowerCase()+"Header"]}`,children:[e.jsx("h2",{children:"معلومات الموظف"}),e.jsx("button",{className:s.closeButton,onClick:x,children:e.jsx(q,{size:20})})]}),e.jsxs("div",{className:s.infoContent,children:[e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"الرقم التعريفي:"}),e.jsx("span",{className:s.infoValue,children:a.id})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"الاسم:"}),e.jsx("span",{className:s.infoValue,children:a.name})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"رقم الهاتف:"}),e.jsx("span",{className:s.infoValue,children:a.number})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"الوظيفة:"}),e.jsx("span",{className:`${s.infoValue} ${s[a.role.toLowerCase()+"Role"]}`,children:S[a.role.toUpperCase()]||a.role})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"ملاحظات:"}),e.jsx("span",{className:s.infoValue,children:a.notes||"لا توجد ملاحظات"})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"تاريخ البدء:"}),e.jsx("span",{className:s.infoValue,children:L(a.created_at.toString())})]}),e.jsxs("div",{className:s.infoItem,children:[e.jsx("span",{className:s.infoLabel,children:"آخر تحديث:"}),e.jsx("span",{className:s.infoValue,children:L(a.updated_at.toString())})]})]}),e.jsx("div",{className:s.infoActions,children:e.jsx("button",{className:s.closeInfoButton,onClick:x,children:"إغلاق"})})]})}),r&&a&&e.jsx("div",{className:s.modalOverlay,children:e.jsxs("div",{className:s.confirmModal,children:[e.jsx("h2",{children:"تأكيد الحذف"}),e.jsxs("p",{children:['هل أنت متأكد من رغبتك في حذف الموظف "',a.name,'"؟',e.jsx("br",{}),"هذا الإجراء لا يمكن التراجع عنه."]}),e.jsxs("div",{className:s.confirmActions,children:[e.jsx("button",{className:s.cancelButton,onClick:x,disabled:I,children:"إلغاء"}),e.jsx("button",{className:s.deleteConfirmButton,onClick:se,disabled:I,children:I?e.jsxs(e.Fragment,{children:[e.jsx(A,{isVisible:!0}),e.jsx("span",{children:"جاري الحذف..."})]}):e.jsx("span",{children:"تأكيد الحذف"})})]})]})})]})};export{Bs as default};
